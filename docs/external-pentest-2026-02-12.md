# External Pentest - 2026-02-12

## Summary

- Status: no HIGH findings in executed black-box test pack.
- Evidence bundle:
  - `reports/pentest/20260212T142609Z/summary.json`
  - `reports/pentest/20260212T142609Z/findings.json`
  - `reports/pentest/20260212T142609Z/pentest-report.md`
- Pass/fail counts from summary:
  - passes: `26`
  - findings: `HIGH=0`, `MEDIUM=0`, `LOW=0`, `INFO=0`

## Scope

Black-box validation from host network against running compose stack:

- gateway (`:8080`)
- verifier (`:8081`)
- policy (`:8082`)
- state (`:8083`)

Test mode used real auth (`AUTH_MODE=oidc_hs256`) and signed JWTs with different roles.

## Methodology

Executed by `scripts/pentest-external.sh`:

1. Bring up stack and wait for health endpoints.
2. Enumerate externally reachable ports (8080-8085 range).
3. Validate baseline security headers on each public endpoint.
4. Validate authn controls:
   - no token -> `401`
   - tampered token -> `401`
5. Validate RBAC controls:
   - operator denied on compliance/key-management endpoints (`403`)
   - security/compliance roles allowed on privileged read endpoints (`200`)
6. Validate internal service-token trust boundary:
   - internal endpoint rejects no token and bearer-only requests (`401`)
   - internal token accepted (non-`401` behavior)
7. Validate CORS policy:
   - allowlisted origin accepted
   - malicious preflight blocked (`403`)
8. Validate body-size abuse resistance:
   - oversized payload rejected (`413`)
9. Validate injection-like input handling:
   - no `500`/panic on malicious query shape

## Concrete Results

- Open ports in tested range: `8080 8081 8082 8083`
- Security headers: present on all tested services.
- AuthN/RBAC checks: passed.
- Internal token gate checks: passed.
- CORS checks: passed.
- Oversized request handling: passed.
- Injection-like query handling: passed.

## Post-run Hardening Applied

After this run, compose host exposure was tightened to loopback-only:

- `infra/docker-compose/docker-compose.yml`
  - `127.0.0.1:8080:8080`
  - `127.0.0.1:8081:8081`
  - `127.0.0.1:8082:8082`
  - `127.0.0.1:8083:8083`

This reduces accidental LAN exposure in local/staging-like host setups.

## Limitations

1. This is not an independent third-party pentest firm report.
2. Test environment was local compose, not production cloud perimeter.
3. DAST crawler/fuzzer depth is bounded; this is a targeted black-box pack, not unlimited fuzzing.
4. Zero-day and infra-side misconfiguration classes remain theoretically possible.

## Recommended Next External Steps

1. Independent external pentest (black-box + gray-box), fixed-scope and retest window.
2. Cloud perimeter validation (WAF/LB/mTLS, security groups, egress controls).
3. Runtime attack simulation for stolen service token and compromised CI secret scenarios.

